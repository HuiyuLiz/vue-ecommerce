(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MusicChartDetail"],{"247c":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("router-link",{staticClass:"btn btn-dark history-back-btn px-3 rounded-0 d-flex d-md-none",attrs:{to:t.lastPath}})],1)},n=[],s={name:"HistoryBackButton",props:{lastPath:{type:Object,required:!0}}},r=s,c=i("2877"),l=Object(c["a"])(r,a,n,!1,null,null,null);e["a"]=l.exports},"2bed":function(t,e,i){},"62e1":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"btn btn-block py-3 mt-0 font-weight-bold rounded-0",class:t.customClass},[t._v("\n  "+t._s(t.text)+"\n")])},n=[],s={name:"CustomButton",props:{text:{type:String,required:!0},customClass:{type:String,required:!0}}},r=s,c=i("2877"),l=Object(c["a"])(r,a,n,!1,null,null,null);e["a"]=l.exports},8650:function(t,e,i){"use strict";var a=i("aec8"),n=i.n(a);n.a},aec8:function(t,e,i){},cef2:function(t,e,i){"use strict";var a=i("2bed"),n=i.n(a);n.a},fe0d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-fluid pt-3 pt-md-5 mt-3 pb-5 background-cover min-height"},[i("HistoryBackButton",{attrs:{"last-path":{name:"MusicCharts"}}}),t.images?i("div",{staticClass:"blur-background d-none d-md-block"},[i("img",{staticClass:"rounded-0 img-object-fit position-absolute",attrs:{alt:"",src:t.images[1].url}})]):t._e(),null!==t.trackId?i("div",{staticClass:"modal slide-fade p-0 align-items-center justify-content-center",attrs:{id:"MusicModal",tabindex:"-1",role:"dialog","aria-labelledby":"MusicModalTitle","aria-hidden":"true","data-backdrop":"static"}},[i("div",{staticClass:"modal-dialog modal-dialog-center m-0 d-flex justify-content-center align-items-center w-100 m-md-auto align-middle",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("button",{staticClass:"close position-absolute align-self-end pt-2 pr-3",attrs:{type:"button"}},[i("span",{staticClass:"display-4",attrs:{"aria-hidden":"true"},on:{click:t.closeTrack}},[t._v("×")])]),i("PlayListIframe",{attrs:{"track-id":t.trackId}})],1)])]):t._e(),i("div",{staticClass:"playlist",attrs:{id:"playlist"}},[""!==t.songId?i("SongIframe",{attrs:{"song-id":t.songId,"is-open":t.isOpen}}):t._e()],1),t.tracks.length>0?i("div",{staticClass:"container pb-5"},[i("div",{staticClass:"row mb-5 mt-md-5 pt-md-3"},[i("div",{staticClass:"col-md-12 mr-auto background-cover d-none d-md-flex flex-md-column justify-content-center align-items-left overflow-hidden"}),i("div",{directives:[{name:"scrollanimation",rawName:"v-scrollanimation"}],staticClass:"col-md-8 m-auto"},[i("div",{},[t._m(0),i("div",{staticClass:"p-md-5 bg-white"},[i("router-link",{staticClass:"text-success font-weight-bold d-flex d-md-none",attrs:{to:{name:"MusicCharts"}}},[t._v("\n              音樂情報\n            ")]),t.title?i("div",{staticClass:"h2 mb-3 d-flex d-md-none mt-2 font-weight-bold"},[t._v("\n              "+t._s(t.title)+"\n            ")]):t._e(),i("div",{staticClass:"d-flex d-md-none mb-3"},[i("img",{staticClass:"img-fluid d-flex d-md-none",attrs:{src:t.images[1].url,alt:""}})]),i("ul",{staticClass:"z-index-3 pl-0 mb-4 mt-4"},[i("router-link",{staticClass:"text-success font-weight-bold d-none d-md-flex",attrs:{to:{name:"MusicCharts"}}},[t._v("\n                音樂情報\n              ")]),t.title?i("li",{staticClass:"text-dark align-items-center mb-2 h2 font-weight-bold mt-2 d-none d-md-flex"},[t._v("\n                "+t._s(t.title)+"\n              ")]):t._e()],1),i("p",[t._v("排行榜計算說明：人氣排行榜計算方式：依照全體會員每日透過撥放軟體（含Web Player）播放歌曲的有效點播次數分類排序，當日顯示資料為前一日的統計結果。 有效點播次數：每位會員聽歌時，一首歌須聽完全曲，才計算為一次。")]),i("div",{staticClass:"row mt-5"},[i("div",{staticClass:"btn-max-width  m-auto "},[i("div",{staticClass:"d-flex mb-4"},[i("CustomButton",{attrs:{"custom-class":"btn-dark",text:"全部試聽"},nativeOn:{click:function(e){return t.openTrack(e)}}})],1)])])],1)])])]),i("div",{staticClass:"row align-items-center mb-3"},[t._m(1),t._m(2),i("div",{staticClass:"col-md-4 ml-auto"},[i("div",{staticClass:"d-flex justify-content-center justify-content-md-end align-items-center"},[i("div",{staticClass:"align-center",on:{click:t.getPrevTrack}},[i("i",{staticClass:"material-icons material-icons-middle text-secondary"},[t._v("keyboard_arrow_left")])]),i("p",{staticClass:"text-secondary h6 text-center mx-3 w-50"},[t._v("\n            第 "+t._s(t.limit_array)+" 名\n          ")]),i("div",{staticClass:"align-center",on:{click:t.getNextTrack}},[i("i",{staticClass:"material-icons material-icons-middle text-secondary"},[t._v("keyboard_arrow_right")])])])])]),i("div",{staticClass:"row border-top pb-3 pb-md-5 min-height d-flex justify-content-center",class:{"slide-fade-enter":t.isChange,"slide-fade-enter-active":!t.isChange}},[i("div",{staticClass:"col-md-6 pr-md-5 justify-content-between"},t._l(t.limit_tracks_first,(function(e,a){return i("MusicTrackItem",{key:e.id,attrs:{track:e,index:a+t.paging.offset,"song-id":t.songId},on:{playSong:t.playSong}})})),1),i("div",{staticClass:"col-md-6 pl-md-5  justify-content-between"},t._l(t.limit_tracks_second,(function(e,a){return i("MusicTrackItem",{key:e.id,staticClass:"border-bottom-none",attrs:{track:e,index:a+t.paging.offset+t.limit_tracks_first.length,"song-id":t.songId},on:{playSong:t.playSong}})})),1)])]):t._e()],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-none d-md-flex align-items-center"},[i("div",{staticClass:"flex-grow-1 pr-2 d-none d-md-block"},[i("div",{staticClass:"line bg-light mb-2 opacity-75"})]),i("div",{staticClass:"h5 text-light font-weight-bold opacity-75"},[t._v("\n              Hot Topic\n            ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"col-md-6 text-center d-none d-md-flex"},[i("h5",{staticClass:"font-weight-bold h5"},[t._v("\n          排名\n        ")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"col-md-6 text-center d-block d-md-none mb-3"},[i("h3",{staticClass:"font-weight-bold h3"},[t._v("\n          排名\n        ")])])}],s=(i("96cf"),i("3b8d")),r=i("70e0"),c=i("2cc0"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"media border-bottom align-items-center py-3 position-relative"},[i("div",{staticClass:"col-2 col-md-3 p-0 d-flex align-items-center mr-3 mr-md-1"},[i("span",{staticClass:"h5 mb-2 font-weight-bold mr-4 font-weight-bold d-none d-md-flex w-25 justify-content-center"},[t._v(t._s(t.index+1)+".")]),i("img",{staticClass:"img-fluid d-none d-md-block w-50",attrs:{src:t.track.album.images[0].url,alt:t.track.name}}),i("img",{staticClass:"d-block d-md-none pr-1",staticStyle:{width:"70px"},attrs:{src:t.track.album.images[0].url,alt:t.track.name}})]),i("div",{staticClass:"col-7 px-0"},[i("div",{staticClass:"media-body"},[i("div",{staticClass:"d-flex align-items-start"},[i("div",{staticClass:"col-11 d-flex flex-column ml-md-3 ml-2"},[i("span",{staticClass:"mb-1 mb-md-2 font-weight-bold",class:{h5:t.track.name.length<20}},[t._v(t._s(t.track.name))]),i("p",{staticClass:"text-secondary mb-0",class:{h7:t.track.album.artist.name.length<20}},[t._v("\n            "+t._s(t.track.album.artist.name)+"\n          ")])])])])]),i("div",{staticClass:"col-3 text-center position-absolute play-icon pr-0",on:{click:function(e){return t.playSong(t.track.id)}}},[i("i",{staticClass:"material-icons material-icons-large",class:{"text-success":t.songId===t.track.id}},[t._v("play_circle_outline")])])])},o=[],d=(i("c5f6"),{name:"MusicTrackItem",props:{songId:{type:String,required:!0},track:{type:Object,required:!0},index:{type:Number,required:!0}},methods:{playSong:function(t){this.$emit("playSong",t)}}}),u=d,m=(i("8650"),i("2877")),g=Object(m["a"])(u,l,o,!1,null,null,null),f=g.exports,h=i("1157"),p=i.n(h),k=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("iframe",{ref:"iframe",attrs:{id:"iframeID",src:"https://widget.kkbox.com/v1/?id="+t.trackId+"&type=playlist&terr=TW&lang=TC&autoplay=false",frameborder:"0",allow:"autoplay",width:"100%"}})])},v=[],b={name:"PlayListIframe",props:{trackId:{type:String,required:!0}},data:function(){return{}}},_=b,C=Object(m["a"])(_,k,v,!1,null,null,null),y=C.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("iframe",{ref:"playSong",staticClass:"p-0",class:{isOpen:t.isOpen,isClose:!t.isOpen},attrs:{id:"playSong",src:"https://widget.kkbox.com/v1/?id="+t.songId+"&type=song&terr=TW&lang=TC&autoplay=true",allow:"autoplay",autoplay:"true",width:"100%",frameborder:"0"}})])},w=[],I={name:"SongIframe",props:{songId:{type:String,required:!0},isOpen:{type:Boolean,required:!0}},data:function(){return{}}},O=I,T=Object(m["a"])(O,x,w,!1,null,null,null),S=T.exports,E=i("62e1"),j=i("247c"),H={name:"MusicChartDetail",components:{MusicTrackItem:f,SongIframe:S,PlayListIframe:y,CustomButton:E["a"],HistoryBackButton:j["a"]},data:function(){return{tracks:[],images:"",songId:"",isOpen:!1,trackId:null,autoplay:!1,isChange:!1,total:0,paging:{},breakPoint:768,clientWidth:null,clientHeight:null}},computed:{limit_tracks_first:function(){var t=this;return this.tracks.filter((function(e,i){return i<t.tracks.length/2}))},limit_tracks_second:function(){var t=this;return this.tracks.filter((function(e,i){return i>=t.tracks.length/2&&i<=t.tracks.length}))},kkbox_token:function(){return this.$store.getters["kkbox/kkbox_token"]},chart_id:function(){return this.$route.query.chart_id},title:function(){return this.$route.params.chart_title},limit_array:function(){var t;return t=null!==this.paging.next?parseInt(this.paging.limit+this.paging.offset):this.total,parseInt(this.paging.offset+1)+" - "+t}},created:function(){var t=document.querySelector("#iframeID");t&&(this.resizeIframeHeight(),window.addEventListener("resize",this.resizeIframeHeight)),window.addEventListener("scroll",this.checkOffset),this.getToken()},mounted:function(){this.$nextTick((function(){window.addEventListener("resize",this.getClientWidth),this.getClientWidth()}))},destroyed:function(){window.removeEventListener("resize",this.resizeIframeHeight),window.removeEventListener("scroll",this.checkOffset),window.removeEventListener("resize",this.getClientWidth)},methods:{getClientWidth:function(){var t=document;this.clientWidth=document.body.clientWidth,this.clientWidth>=this.breakPoint?this.clientHeight=t.documentElement.clientHeight-200:this.clientHeight=t.documentElement.clientHeight},openTrack:function(){var t=this;this.isOpen&&setTimeout((function(){t.isOpen=!t.isOpen,t.songId=""}),1e3),setTimeout((function(){t.trackId=t.chart_id}),1500),setTimeout((function(){t.resizeIframeHeight(),p()("#MusicModal").modal("show")}),2e3)},closeTrack:function(t){p()("#MusicModal").modal("hide"),this.trackId=null},resizeIframeHeight:function(){var t=document.querySelector("#iframeID");t.height=t?this.clientHeight+"px":null},checkOffset:function(){var t=document.querySelector(".playlist"),e=document.querySelector(".footer"),i=e.offsetTop;t.style.position=t?"absolute":null,window.scrollY+window.innerHeight<=i&&(t.style.position="fixed")},getToken:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("kkbox/GET_KKBOX_TOKEN");case 2:return t.next=4,this.getChartList();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getPagingApi:function(t){var e=this,i={headers:{Authorization:"".concat(this.kkbox_token)}};if(null===t)return!1;this.isChange=!0,this.$http.get(t,i).then((function(t){e.$store.commit("loading/loading_status",!1),t.data.data?(t.data.data?e.tracks=t.data.data:e.tracks=[],null!==t.data.pagin?e.paging=t.data.paging:e.paging=null,e.isChange=!1):r["a"].emitHandler(!1,"取得資料錯誤")})).catch((function(t){(t||t instanceof ReferenceError)&&r["a"].emitHandler(!1,"取得資料錯誤")}))},getChartList:function(){var t=this;this.$store.commit("loading/loading_status",!0);var e={headers:{Authorization:"".concat(this.kkbox_token)}};Object(c["a"])(e,this.chart_id).then((function(e){t.$store.commit("loading/loading_status",!1),e.data.data?(e.data.data?t.tracks=e.data.data:t.tracks=[],t.tracks[0].album.images?t.images=t.tracks[0].album.images:t.images="",null!==e.data.pagin?t.paging=e.data.paging:t.paging=null,t.total=e.data.summary.total):r["a"].emitHandler(!1,"取得資料錯誤")})).catch((function(t){(t||t instanceof ReferenceError)&&r["a"].emitHandler(!1,"取得資料錯誤")}))},getPrevTrack:function(t){this.getPagingApi(this.paging.previous)},getNextTrack:function(){this.getPagingApi(this.paging.next)},playSong:function(t){var e=this;this.songId=t;var i=document.querySelector(".playlist");i.style.position="fixed",this.checkOffset(),this.isOpen||setTimeout((function(){e.isOpen=!e.isOpen}),1e3)}}},$=H,M=(i("cef2"),Object(m["a"])($,a,n,!1,null,"a599773c",null));e["default"]=M.exports}}]);
//# sourceMappingURL=MusicChartDetail.8e62b644.js.map